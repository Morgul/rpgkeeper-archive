<div class="power">
    <h4 class="title {{ powerRef.power.type.toLowerCase() }}" ng-click="collapseClick()">
        <span  ng-repeat="i in range(powerRef.maxUses) track by $index">
            <i title="Indicates if a power has been used." ng-if="powerRef.power.type != 'At-Will'" class="{{ getUseIcon(powerRef, $index) }}" ng-click="handleUse(powerRef, $index, $event)"></i>
        </span>
        <button type="button" title="Remove this power" class="close" aria-hidden="true" ng-click="removePower(powerRef, $event)">&times;</button>
        <button type="button" title="Edit this power" class="close edit" aria-hidden="true" ng-click="editPowerRef(powerRef, $event)"><i class="icon-edit"></i></button>
        <span class="type-level" ng-switch="powerRef.power.kind">{{ powerRef.power.kind }}<span ng-if="powerRef.power.level"> {{ powerRef.power.level }}</span></span>
        <b>{{ powerRef.power.name }}</b>
    </h4>
    <div collapse="collapsePower">
        <div class="flavor" ng-if="powerRef.power.flavor">{{ powerRef.power.flavor }}
        </div>
        <div class="section details">
            <div>
                <b>{{ powerRef.power.type }}</b>
                <span ng-if="powerRef.power.keywords">&diams; <b>{{ powerRef.power.keywords.join(', ') }}</b></span>
            </div>
            <div>
                <span style="display: inline-block; width: 49.5%;"><b>{{ powerRef.power.actionType }}</b></span>
                <span style="display: inline-block; width: 49.5%;"><b>{{ powerRef.power.range }}</b></span>
            </div>
        </div>
        <div class="sections">
            <div class="section" ng-repeat="section in powerRef.power.sections">
                <b>{{ section.title }}:</b> <span ng-bind-html="section.content | markdown"></span>
            </div>
            <div class="section notes" ng-if="powerRef.notes">
                <b>Notes:</b> <span ng-bind-html="powerRef.notes | markdown"></span>
            </div>
        </div>
        <div  ng-if="powerRef.rolls" class="rolls">
            <div class="row">
                <div ng-class="getPowerRollSize($index, $last)" ng-repeat="roll in powerRef.rolls">
                    <roll-button class="btn-block" roll-title="'[' + powerRef.power.name + '] ' + roll.title" roll="roll" context="sysChar"></roll-button>
                </div>
            </div>
        </div>
    </div>
</div>
